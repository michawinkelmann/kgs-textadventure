<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>KGS Text-Adventure (Chat-Story)</title>
  <link rel="stylesheet" href="./style.css" />
</head>
<body>
  <noscript>
    <div style="padding:12px;margin:12px;border:1px solid #ccc;border-radius:10px">
      Bitte JavaScript aktivieren, sonst läuft das Spiel nicht.
    </div>
  </noscript>

  <header class="topbar">
    <div class="brand">
      <div class="brand__title">KGS Text‑Adventure</div>
      <div class="brand__subtitle" id="locationLine">…</div>
    </div>

    <div class="topbar__actions">
      <button class="btn btn--ghost" id="btnSave" type="button" title="Speichern">Speichern</button>
      <button class="btn btn--ghost" id="btnReset" type="button" title="Neustart">Neustart</button>
    </div>
  </header>

  <main class="app">
    <!-- Bildbereich -->
    <section class="panel scene" aria-label="Ort / Szene">
      <div class="scene__frame">
        <img id="sceneImg" alt="Szene" loading="eager" />
        <div class="scene__glow" aria-hidden="true"></div>
      </div>
      <div class="scene__caption">
        <div class="scene__title" id="sceneTitle">…</div>
        <div class="scene__meta" id="sceneMeta">…</div>
      </div>

      <div class="scene__map">
        <div class="scene__mapHeader">
  <div class="scene__mapLeft">
    <div class="scene__mapTitle">Karte</div>
    <div class="scene__mapHint">Klick: bewegen oder Route anzeigen</div>
  </div>

  <div class="scene__mapTabs" role="tablist" aria-label="Kartenmodus">
    <button class="tab tab--active" id="mapModeNear" type="button" role="tab" aria-selected="true" title="Nur Umgebung anzeigen">Umgebung</button>
    <button class="tab" id="mapModeAll" type="button" role="tab" aria-selected="false" title="Ganzes Gebäude anzeigen">Gesamt</button>
  </div>
</div>
        <div id="mapBox" class="map" aria-label="Karte"></div>
        <div class="map__legend" aria-hidden="true">
          <span class="lg lg--here"></span> Du •
          <span class="lg lg--near"></span> Nachbar •
          <span class="lg lg--far"></span> Ort •
          <span class="lg lg--lock"></span> gesperrt
        </div>
      </div>
    </section>

    <!-- Log + Input (Chat) -->
    <section class="panel chat" aria-label="Chat">
      <div class="chat__log" id="log" aria-live="polite" aria-relevant="additions"></div>

      <form class="chat__input" id="inputForm" autocomplete="off">
        <input
          id="commandInput"
          class="chat__field"
          type="text"
          placeholder="z.B. ‚hilfe‘, ‚gehen mensa‘, ‚rede pietsch‘, ‚untersuche schild‘"
          aria-label="Befehl eingeben"
        />
        <button class="btn btn--primary" type="submit">Senden</button>
      </form>
    </section>

    <!-- Hilfe/Commands -->
    <aside class="panel help" aria-label="Hilfe">
      <div class="help__scroll">
        <div class="help__section">
          <div class="help__title">Nächster sinnvoller Schritt</div>
          <div class="help__box help__next" id="nextStepBox">
            <div class="help__muted">Lade Priorität …</div>
          </div>
        </div>

        <div class="help__section">
          <div class="help__title">Kontext</div>
          <div class="help__box" id="contextBox">
            <div class="help__muted">Lade …</div>
          </div>
        </div>

        <div class="help__section">
          <div class="help__title">Beziehungen</div>
          <div class="help__box" id="relationshipBox">
            <div class="help__muted">Noch keine wichtigen Kontakte bekannt.</div>
          </div>
        </div>

        <div class="help__section">
          <div class="help__title">Quests</div>
          <div class="help__box" id="questBox">
            <div class="help__muted">—</div>
          </div>
        </div>

        <div class="help__section">
          <div class="help__title">Commands</div>
          <div class="help__box">
            <ul class="help__list">
              <li><code>hilfe</code> – zeigt Hilfe</li>
              <li><code>wo</code> – beschreibt den Ort nochmal</li>
              <li><code>gehen &lt;ziel&gt;</code> – Ort wechseln</li>
              <li><code>untersuche &lt;ding&gt;</code> – anschauen</li>
              <li><code>rede &lt;name&gt;</code> – mit NPC sprechen</li>
              <li><code>nimm &lt;item&gt;</code> – Item nehmen</li>
              <li><code>gib &lt;item&gt; &lt;name&gt;</code> – Item übergeben</li>
              <li><code>inventar</code> – deine Items</li>
              <li><code>quests</code> – Quest-Status</li>
              <li><code>klar</code> – Chat leeren</li>
            </ul>
          </div>
        </div>

        <div class="help__section">
          <div class="help__title">Tipp</div>
          <div class="help__box help__muted">
            Vorschläge im Kontext lösen Aktionen direkt aus. Shift‑Klick oder Long‑Press übernimmt sie nur ins Eingabefeld.
          </div>
        </div>
      </div>
    </aside>
  </main>

  <script src="./data/world.js"></script>
  <script src="./game.js"></script>
</body>
</html>
